<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ–∑–¥–∞—Ç—å —Ñ–ª–µ–π—Ç—É - WITG</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        header h1 {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .back-btn {
            color: white;
            text-decoration: none;
            padding: 8px 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 5px;
            float: left;
            transition: background 0.3s;
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .content {
            padding: 30px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .form-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            border: 2px solid #e9ecef;
        }
        
        .form-section h3 {
            color: #2E7D32;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ced4da;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }
        
        .range-value {
            display: inline-block;
            margin-left: 10px;
            font-weight: bold;
            color: #2E7D32;
        }
        
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }
        
        .component-card {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .component-card:hover {
            border-color: #4CAF50;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .component-card.selected {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }
        
        .component-card h4 {
            color: #2E7D32;
            margin-bottom: 5px;
        }
        
        .component-card p {
            font-size: 0.9em;
            color: #666;
            margin: 3px 0;
        }
        
        .actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            min-width: 200px;
            justify-content: center;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(76, 175, 80, 0.3);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .preview-section {
            margin-top: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }
        
        .preview-section h3 {
            color: #2E7D32;
            margin-bottom: 20px;
        }
        
        #flute-preview {
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 1px solid #dee2e6;
            min-height: 100px;
        }
        
        .preview-item {
            margin: 10px 0;
            padding: 10px;
            background: #e9ecef;
            border-radius: 5px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error {
            color: #dc3545;
            padding: 10px;
            background: #f8d7da;
            border-radius: 5px;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="/" class="back-btn">‚Üê –ù–∞–∑–∞–¥</a>
            <h1>üéµ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ–ª–µ–π—Ç—ã</h1>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤–∞—à–µ–π —Ñ–ª–µ–π—Ç—ã</p>
        </header>
        
        <div class="content">
            <div class="form-grid">
                <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã -->
                <div class="form-section">
                    <h3>üìù –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
                    <div class="form-group">
                        <label for="flute-name">–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–ª–µ–π—Ç—ã</label>
                        <input type="text" id="flute-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ—è –ø–µ—Ä–≤–∞—è —Ñ–ª–µ–π—Ç–∞ –≤ D">
                    </div>
                    
                    <div class="form-group">
                        <label for="key">–¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å</label>
                        <select id="key">
                            <option value="C">C (–î–æ)</option>
                            <option value="D" selected>D (–†–µ)</option>
                            <option value="E">E (–ú–∏)</option>
                            <option value="F">F (–§–∞)</option>
                            <option value="G">G (–°–æ–ª—å)</option>
                            <option value="A">A (–õ—è)</option>
                            <option value="B">B (–°–∏)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="tube-length">–î–ª–∏–Ω–∞ —Ç—Ä—É–±–∫–∏ (–º–º)
                            <span id="length-value" class="range-value">450</span>
                        </label>
                        <input type="range" id="tube-length" min="200" max="800" value="450" step="10">
                    </div>
                    
                    <div class="form-group">
                        <label for="hole-count">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π</label>
                        <select id="hole-count">
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6" selected>6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                        </select>
                    </div>
                </div>
                
                <!-- –ú—É–Ω–¥—à—Ç—É–∫ -->
                <div class="form-section">
                    <h3>üé∫ –ú—É–Ω–¥—à—Ç—É–∫</h3>
                    <div id="mouthpieces-loading" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ –º—É–Ω–¥—à—Ç—É–∫–æ–≤...
                    </div>
                    <div class="card-grid" id="mouthpieces-cards" style="display: none;">
                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –º—É–Ω–¥—à—Ç—É–∫–æ–≤ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>
                
                <!-- –¢—Ä—É–±–∫–∞ -->
                <div class="form-section">
                    <h3>üéµ –¢—Ä—É–±–∫–∞</h3>
                    <div id="tubes-loading" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä—É–±–æ–∫...
                    </div>
                    <div class="card-grid" id="tubes-cards" style="display: none;">
                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —Ç—Ä—É–±–æ–∫ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>
                
                <!-- –†–∞—Å—Ç—Ä—É–± -->
                <div class="form-section">
                    <h3>üé∑ –†–∞—Å—Ç—Ä—É–±</h3>
                    <div id="bells-loading" class="loading">
                        –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å—Ç—Ä—É–±–æ–≤...
                    </div>
                    <div class="card-grid" id="bells-cards" style="display: none;">
                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —Ä–∞—Å—Ç—Ä—É–±–æ–≤ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>
            </div>
            
            <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä -->
            <div class="preview-section">
                <h3>üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</h3>
                <div id="flute-preview">
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞...</p>
                </div>
            </div>
            
            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
            <div id="error-message" class="error"></div>
            
            <!-- –î–µ–π—Å—Ç–≤–∏—è -->
            <div class="actions">
                <button class="btn btn-secondary" onclick="window.location.href='/'">
                    ‚ùå –û—Ç–º–µ–Ω–∞
                </button>
                <button class="btn btn-primary" onclick="createFlute()">
                    ‚úÖ –°–æ–∑–¥–∞—Ç—å —Ñ–ª–µ–π—Ç—É
                </button>
                <button class="btn btn-primary" onclick="calculateAndCreate()">
                    üîÑ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏ —Å–æ–∑–¥–∞—Ç—å
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // –í—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
        let selectedComponents = {
            mouthpiece: null,
            tube: null,
            bell: null
        };
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            loadMouthpieces();
            loadTubes();
            loadBells();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
            document.getElementById('flute-name').addEventListener('input', updatePreview);
            document.getElementById('key').addEventListener('change', updatePreview);
            document.getElementById('tube-length').addEventListener('input', updatePreview);
            document.getElementById('hole-count').addEventListener('change', updatePreview);
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª–∏–Ω—ã
            document.getElementById('tube-length').addEventListener('input', function() {
                document.getElementById('length-value').textContent = this.value;
                updatePreview();
            });
        });
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –º—É–Ω–¥—à—Ç—É–∫–æ–≤
        async function loadMouthpieces() {
            try {
                const response = await fetch('/api/mouthpieces');
                const data = await response.json();
                
                document.getElementById('mouthpieces-loading').style.display = 'none';
                const container = document.getElementById('mouthpieces-cards');
                container.style.display = 'grid';
                container.innerHTML = '';
                
                // –ö–∞—Ä—Ç–æ—á–∫–∞ "–ù–µ—Ç –º—É–Ω–¥—à—Ç—É–∫–∞"
                const noneCard = createComponentCard(null, 'mouthpiece', '–ë–µ–∑ –º—É–Ω–¥—à—Ç—É–∫–∞', '–ù–∞—Ç–∏–≤–Ω–∞—è —Ñ–ª–µ–π—Ç–∞');
                container.appendChild(noneCard);
                
                // –ö–∞—Ä—Ç–æ—á–∫–∏ –º—É–Ω–¥—à—Ç—É–∫–æ–≤
                if (data.mouthpieces && data.mouthpieces.length > 0) {
                    data.mouthpieces.forEach(mp => {
                        const card = createComponentCard(
                            mp.id,
                            'mouthpiece',
                            mp.name,
                            `–î–∏–∞–º–µ—Ç—Ä: ${mp.inner_diameter || '?'}–º–º`,
                            mp.type || ''
                        );
                        container.appendChild(card);
                    });
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º—É–Ω–¥—à—Ç—É–∫–æ–≤:', error);
                document.getElementById('mouthpieces-loading').innerHTML = 
                    '<p style="color: red;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</p>';
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä—É–±–æ–∫
        async function loadTubes() {
            try {
                const response = await fetch('/api/tubes');
                const data = await response.json();
                
                document.getElementById('tubes-loading').style.display = 'none';
                const container = document.getElementById('tubes-cards');
                container.style.display = 'grid';
                container.innerHTML = '';
                
                if (data.tubes && data.tubes.length > 0) {
                    data.tubes.forEach(tube => {
                        const card = createComponentCard(
                            tube.id,
                            'tube',
                            tube.name,
                            `–î–∏–∞–º–µ—Ç—Ä: ${tube.inner_diameter}–º–º`,
                            tube.material || ''
                        );
                        container.appendChild(card);
                    });
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç—Ä—É–±–æ–∫:', error);
                document.getElementById('tubes-loading').innerHTML = 
                    '<p style="color: red;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</p>';
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å—Ç—Ä—É–±–æ–≤
        async function loadBells() {
            try {
                const response = await fetch('/api/bells');
                const data = await response.json();
                
                document.getElementById('bells-loading').style.display = 'none';
                const container = document.getElementById('bells-cards');
                container.style.display = 'grid';
                container.innerHTML = '';
                
                // –ö–∞—Ä—Ç–æ—á–∫–∞ "–ë–µ–∑ —Ä–∞—Å—Ç—Ä—É–±–∞"
                const noneCard = createComponentCard(null, 'bell', '–ë–µ–∑ —Ä–∞—Å—Ç—Ä—É–±–∞', '–ü—Ä—è–º–∞—è —Ç—Ä—É–±–∫–∞');
                container.appendChild(noneCard);
                
                // –ö–∞—Ä—Ç–æ—á–∫–∏ —Ä–∞—Å—Ç—Ä—É–±–æ–≤
                if (data.bells && data.bells.length > 0) {
                    data.bells.forEach(bell => {
                        const card = createComponentCard(
                            bell.id,
                            'bell',
                            bell.name,
                            bell.type === 'none' ? '–ë–µ–∑ —Ä–∞—Å—Ç—Ä—É–±–∞' : `–¢–∏–ø: ${bell.type}`,
                            ''
                        );
                        container.appendChild(card);
                    });
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å—Ç—Ä—É–±–æ–≤:', error);
                document.getElementById('bells-loading').innerHTML = 
                    '<p style="color: red;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</p>';
            }
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
        function createComponentCard(id, type, title, subtitle, extra = '') {
            const card = document.createElement('div');
            card.className = 'component-card';
            card.dataset.id = id;
            card.dataset.type = type;
            
            card.innerHTML = `
                <h4>${title}</h4>
                <p>${subtitle}</p>
                ${extra ? `<p><small>${extra}</small></p>` : ''}
            `;
            
            card.addEventListener('click', () => selectComponent(id, type));
            
            return card;
        }
        
        // –í—ã–±–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
        function selectComponent(id, type) {
            selectedComponents[type] = id;
            
            // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –∫–∞—Ä—Ç–æ—á–µ–∫ —ç—Ç–æ–≥–æ —Ç–∏–ø–∞
            const allCards = document.querySelectorAll(`.component-card[data-type="${type}"]`);
            allCards.forEach(card => card.classList.remove('selected'));
            
            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É
            const selectedCard = document.querySelector(`.component-card[data-type="${type}"][data-id="${id}"]`);
            if (selectedCard) {
                selectedCard.classList.add('selected');
            }
            
            updatePreview();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
        function updatePreview() {
            const name = document.getElementById('flute-name').value || '–ù–æ–≤–∞—è —Ñ–ª–µ–π—Ç–∞';
            const key = document.getElementById('key').value;
            const length = document.getElementById('tube-length').value;
            const holes = document.getElementById('hole-count').value;
            
            let previewHTML = `
                <div class="preview-item">
                    <strong>${name}</strong>
                </div>
                <div class="preview-item">
                    –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: <strong>${key}</strong> | –î–ª–∏–Ω–∞: <strong>${length}–º–º</strong> | –û—Ç–≤–µ—Ä—Å—Ç–∏–π: <strong>${holes}</strong>
                </div>
            `;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
            const components = ['mouthpiece', 'tube', 'bell'];
            components.forEach(type => {
                if (selectedComponents[type]) {
                    const card = document.querySelector(`.component-card[data-type="${type}"][data-id="${selectedComponents[type]}"]`);
                    if (card) {
                        const title = card.querySelector('h4').textContent;
                        previewHTML += `<div class="preview-item">${getComponentLabel(type)}: ${title}</div>`;
                    }
                }
            });
            
            document.getElementById('flute-preview').innerHTML = previewHTML;
        }
        
        function getComponentLabel(type) {
            const labels = {
                mouthpiece: '–ú—É–Ω–¥—à—Ç—É–∫',
                tube: '–¢—Ä—É–±–∫–∞',
                bell: '–†–∞—Å—Ç—Ä—É–±'
            };
            return labels[type] || type;
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–ª–µ–π—Ç—ã
        async function createFlute() {
            const name = document.getElementById('flute-name').value;
            const key = document.getElementById('key').value;
            const length = document.getElementById('tube-length').value;
            const holes = document.getElementById('hole-count').value;
            
            if (!name.trim()) {
                showError('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–ª–µ–π—Ç—ã');
                return;
            }
            
            if (!selectedComponents.tube) {
                showError('–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä—É–±–∫—É');
                return;
            }
            
            const fluteData = {
                name: name,
                key: key,
                tube_length: parseInt(length),
                hole_count: parseInt(holes),
                mouthpiece_id: selectedComponents.mouthpiece || null,
                tube_id: selectedComponents.tube,
                bell_id: selectedComponents.bell || null
            };
            
            try {
                const response = await fetch('/api/flutes', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(fluteData)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    alert(`‚úÖ –§–ª–µ–π—Ç–∞ "${name}" —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!`);
                    window.location.href = '/';
                } else {
                    showError(`–û—à–∏–±–∫–∞: ${result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`);
                }
            } catch (error) {
                showError(`–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`);
            }
        }
        
        // –†–∞—Å—á–µ—Ç –∏ —Å–æ–∑–¥–∞–Ω–∏–µ
        async function calculateAndCreate() {
            // –°–Ω–∞—á–∞–ª–∞ —Ä–∞—Å—Å—á–∏—Ç–∞–µ–º –æ—Ç–≤–µ—Ä—Å—Ç–∏—è, –ø–æ—Ç–æ–º —Å–æ–∑–¥–∞–¥–∏–º —Ñ–ª–µ–π—Ç—É
            const length = document.getElementById('tube-length').value;
            const key = document.getElementById('key').value;
            const holes = document.getElementById('hole-count').value;
            
            try {
                const response = await fetch('/api/calculate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        tube_length: parseInt(length),
                        key: key,
                        hole_count: parseInt(holes)
                    })
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    alert(`‚úÖ –†–∞—Å—á–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω! –ü–æ–∑–∏—Ü–∏–∏ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã.`);
                    // –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–µ–º —Ñ–ª–µ–π—Ç—É —Å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ –æ—Ç–≤–µ—Ä—Å—Ç–∏—è–º–∏
                    createFlute();
                } else {
                    showError(`–û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞: ${result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`);
                }
            } catch (error) {
                showError(`–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`);
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É
        function showError(message) {
            const errorDiv = document.getElementById('error-message');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }
    </script>
</body>
</html>