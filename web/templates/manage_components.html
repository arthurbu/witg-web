<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ - WITG</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        header h1 {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .back-btn {
            color: white;
            text-decoration: none;
            padding: 8px 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 5px;
            float: left;
            transition: background 0.3s;
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .content {
            padding: 30px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }
        
        .tab-btn {
            padding: 12px 25px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 8px 8px 0 0;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab-btn.active {
            background: #4CAF50;
            transform: translateY(-2px);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .components-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .component-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #e9ecef;
            transition: all 0.3s;
            position: relative;
        }
        
        .component-card:hover {
            border-color: #4CAF50;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .component-card h3 {
            color: #2E7D32;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .component-param {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 5px 0;
            border-bottom: 1px dashed #dee2e6;
        }
        
        .param-label {
            color: #666;
            font-weight: 500;
        }
        
        .param-value {
            font-weight: 600;
            color: #2E7D32;
        }
        
        .measurement-status {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 600;
        }
        
        .status-complete {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status-partial {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .status-required {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .form-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }
        
        .form-section h3 {
            color: #2E7D32;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .required::after {
            content: "*";
            color: #dc3545;
            margin-left: 4px;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px 15px;
            border: 2px solid #ced4da;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }
        
        .form-group small {
            margin-top: 5px;
            color: #6c757d;
            font-size: 0.85em;
        }
        
        .measurement-section {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            border: 1px solid #dee2e6;
        }
        
        .measurement-section h4 {
            color: #2196F3;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .measurement-section p {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
            padding: 8px;
            background: #e3f2fd;
            border-radius: 5px;
            border-left: 4px solid #2196F3;
        }
        
        .calibration-result {
            margin-top: 15px;
            padding: 12px;
            background: #d4edda;
            border-radius: 5px;
            border: 1px solid #c3e6cb;
            text-align: center;
        }
        
        .calibration-result h5 {
            color: #155724;
            margin-bottom: 5px;
        }
        
        .calibration-result p {
            font-size: 1.2em;
            font-weight: bold;
            color: #2E7D32;
            margin: 5px 0;
        }
        
        .calculation-section {
            margin-top: 20px;
            padding: 15px;
            background: #fff3cd;
            border-radius: 8px;
            border: 1px solid #ffeaa7;
        }
        
        .calculation-section h4 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .calculation-result {
            font-weight: bold;
            color: #856404;
            padding: 8px;
            background: white;
            border-radius: 5px;
            border: 1px solid #ffd54f;
            text-align: center;
            margin-top: 10px;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .btn-info:hover {
            background: #138496;
        }
        
        .actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error {
            color: #dc3545;
            padding: 10px;
            background: #f8d7da;
            border-radius: 5px;
            margin-top: 10px;
            display: none;
        }
        
        .success {
            color: #28a745;
            padding: 10px;
            background: #d4edda;
            border-radius: 5px;
            margin-top: 10px;
            display: none;
        }
        
        .warning {
            color: #856404;
            padding: 10px;
            background: #fff3cd;
            border-radius: 5px;
            margin-top: 10px;
            border: 1px solid #ffeaa7;
        }
        
        .parameter-category {
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        
        .parameter-category h4 {
            color: #2E7D32;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .input-with-unit {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .input-with-unit input {
            flex: 1;
        }
        
        .unit {
            min-width: 50px;
            color: #666;
            font-weight: 500;
        }
        
        .parameter-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .parameter-table th,
        .parameter-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }
        
        .parameter-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }
        
        .parameter-table input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="/" class="back-btn">‚Üê –ù–∞–∑–∞–¥</a>
            <h1>üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏</h1>
            <p>–ë–∞–∑—ã –º—É–Ω–¥—à—Ç—É–∫–æ–≤, —Ç—Ä—É–±–æ–∫ –∏ —Ä–∞—Å—Ç—Ä—É–±–æ–≤ —Å –∞–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏</p>
        </header>
        
        <div class="content">
            <div class="tabs">
                <button class="tab-btn active" data-tab="mouthpieces">üé∫ –ú—É–Ω–¥—à—Ç—É–∫–∏</button>
                <button class="tab-btn" data-tab="tubes">üéµ –¢—Ä—É–±–∫–∏</button>
                <button class="tab-btn" data-tab="bells">üé∑ –†–∞—Å—Ç—Ä—É–±—ã</button>
            </div>
            
            <!-- –ú—É–Ω–¥—à—Ç—É–∫–∏ -->
            <div id="mouthpieces-tab" class="tab-content active">
                <div class="warning">
                    <strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</strong> –î–ª—è —Ç–æ—á–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –∞–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è.
                    –ë–µ–∑ –Ω–∏—Ö –ø–æ–∑–∏—Ü–∏–∏ –æ—Ç–≤–µ—Ä—Å—Ç–∏–π –±—É–¥—É—Ç –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–º–∏.
                </div>
                
                <div class="form-section">
                    <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –º—É–Ω–¥—à—Ç—É–∫</h3>
                    
                    <div class="parameter-category">
                        <h4>üìè –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–∏–∑–º–µ—Ä—è—Ç—å —à—Ç–∞–Ω–≥–µ–Ω—Ü–∏—Ä–∫—É–ª–µ–º)</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="mp-name" class="required">–ù–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–¥—à—Ç—É–∫–∞</label>
                                <input type="text" id="mp-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Clarinet_Bb_std">
                            </div>
                            <div class="form-group">
                                <label for="mp-type" class="required">–¢–∏–ø –º—É–Ω–¥—à—Ç—É–∫–∞</label>
                                <select id="mp-type">
                                    <option value="clarinet">–ö–ª–∞—Ä–Ω–µ—Ç</option>
                                    <option value="alto_sax">–ê–ª—å—Ç —Å–∞–∫—Å–æ—Ñ–æ–Ω</option>
                                    <option value="tenor_sax">–¢–µ–Ω–æ—Ä —Å–∞–∫—Å–æ—Ñ–æ–Ω</option>
                                    <option value="soprano_sax">–°–æ–ø—Ä–∞–Ω–æ —Å–∞–∫—Å–æ—Ñ–æ–Ω</option>
                                    <option value="bass_clarinet">–ë–∞—Å—Å –∫–ª–∞—Ä–Ω–µ—Ç</option>
                                    <option value="native">–ù–∞—Ç–∏–≤–Ω—ã–π (–¥—É–¥–∏–∫—Å)</option>
                                    <option value="flute">–ü–æ–ø–µ—Ä–µ—á–Ω–∞—è —Ñ–ª–µ–π—Ç–∞</option>
                                    <option value="recorder">–†–µ–∫–æ—Ä–¥–µ—Ä</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="mp-brand">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å</label>
                                <input type="text" id="mp-brand" placeholder="Yamaha, Selmer, Vandoren, Bari">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="mp-d-tip" class="required">–î–∏–∞–º–µ—Ç—Ä —É —Ç—Ä–æ—Å—Ç–∏ (d_tip), –º–º</label>
                                <div class="input-with-unit">
                                    <input type="number" id="mp-d-tip" step="0.01" min="8" max="30" value="13.5">
                                    <span class="unit">–º–º</span>
                                </div>
                                <small>–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–∏–∞–º–µ—Ç—Ä —Ç–∞–º, –≥–¥–µ –ª–µ–∂–∏—Ç —Ç—Ä–æ—Å—Ç—å</small>
                            </div>
                            <div class="form-group">
                                <label for="mp-d-out" class="required">–î–∏–∞–º–µ—Ç—Ä –≤—ã—Ö–æ–¥–∞ (d_out), –º–º</label>
                                <div class="input-with-unit">
                                    <input type="number" id="mp-d-out" step="0.01" min="10" max="40" value="14.7">
                                    <span class="unit">–º–º</span>
                                </div>
                                <small>–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–∏–∞–º–µ—Ç—Ä –Ω–∞ –∫–æ–Ω—Ü–µ (–≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ç—Ä—É–±–∫—É)</small>
                            </div>
                            <div class="form-group">
                                <label for="mp-L-m" class="required">–î–ª–∏–Ω–∞ –∞–∫—É—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—É—Å–∞ (L_m), –º–º</label>
                                <div class="input-with-unit">
                                    <input type="number" id="mp-L-m" step="0.1" min="30" max="200" value="75.0">
                                    <span class="unit">–º–º</span>
                                </div>
                                <small>–û—Ç –∫–æ–Ω—á–∏–∫–∞ —Ç—Ä–æ—Å—Ç–∏ –¥–æ –Ω–∞—á–∞–ª–∞ —Ü–∏–ª–∏–Ω–¥—Ä–∏—á–µ—Å–∫–æ–π —á–∞—Å—Ç–∏</small>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="mp-L-cyl">–î–ª–∏–Ω–∞ —Ü–∏–ª–∏–Ω–¥—Ä–∏—á–µ—Å–∫–æ–π —á–∞—Å—Ç–∏ (L_cyl), –º–º</label>
                                <div class="input-with-unit">
                                    <input type="number" id="mp-L-cyl" step="0.1" min="0" max="100" value="0.0">
                                    <span class="unit">–º–º</span>
                                </div>
                                <small>–ï—Å–ª–∏ –µ—Å—Ç—å —Ü–∏–ª–∏–Ω–¥—Ä–∏—á–µ—Å–∫–∏–π —É—á–∞—Å—Ç–æ–∫ –ø–æ—Å–ª–µ –∫–æ–Ω—É—Å–∞</small>
                            </div>
                            <div class="form-group">
                                <label for="mp-baffle">–¢–∏–ø —Å–≤–æ–¥–∞ (Baffle)</label>
                                <select id="mp-baffle">
                                    <option value="low_straight">–ù–∏–∑–∫–∏–π –ø—Ä—è–º–æ–π</option>
                                    <option value="high_straight">–í—ã—Å–æ–∫–∏–π –ø—Ä—è–º–æ–π</option>
                                    <option value="low_step">–ù–∏–∑–∫–∏–π —Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π</option>
                                    <option value="high_step">–í—ã—Å–æ–∫–∏–π —Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π</option>
                                    <option value="curved">–ò–∑–æ–≥–Ω—É—Ç—ã–π</option>
                                    <option value="rollover">Roll-over baffle</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="mp-chamber">–ì–ª—É–±–∏–Ω–∞ –∫–∞–º–µ—Ä—ã, –º–º</label>
                                <div class="input-with-unit">
                                    <input type="number" id="mp-chamber" step="0.1" min="5" max="50" value="15.0">
                                    <span class="unit">–º–º</span>
                                </div>
                                <small>–û—Ç –æ–∫–Ω–∞ –¥–æ –∑–∞–¥–Ω–µ–π —Å—Ç–µ–Ω–∫–∏</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="parameter-category">
                        <h4>üéµ –ê–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–ª—è —Ç–æ—á–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤!)</h4>
                        
                        <div class="measurement-section">
                            <h4>üìê –ò–∑–º–µ—Ä–µ–Ω–∏–µ —ç–Ω–¥-–∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ (Œ¥_m)</h4>
                            <p><strong>–ú–µ—Ç–æ–¥–∏–∫–∞:</strong> –í–æ–∑—å–º–∏—Ç–µ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—É—é —Ç—Ä—É–±–∫—É –¥–ª–∏–Ω–æ–π 400–º–º (L_calib) —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –¥–∏–∞–º–µ—Ç—Ä–æ–º 13–º–º (d_calib), —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º—É–Ω–¥—à—Ç—É–∫ –∏ –∏–∑–º–µ—Ä—å—Ç–µ –æ—Å–Ω–æ–≤–Ω—É—é —á–∞—Å—Ç–æ—Ç—É (f_meas).</p>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="mp-L-calib">–î–ª–∏–Ω–∞ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π —Ç—Ä—É–±–∫–∏</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="mp-L-calib" step="0.1" value="400.0">
                                        <span class="unit">–º–º</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="mp-d-calib">–î–∏–∞–º–µ—Ç—Ä –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π —Ç—Ä—É–±–∫–∏</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="mp-d-calib" step="0.01" value="13.0">
                                        <span class="unit">–º–º</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="mp-f-meas" class="required">–ò–∑–º–µ—Ä–µ–Ω–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ (f_meas)</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="mp-f-meas" step="0.1" min="100" max="500" value="320.0">
                                        <span class="unit">–ì—Ü</span>
                                    </div>
                                    <small>–û—Å–Ω–æ–≤–Ω–æ–π —Ç–æ–Ω –Ω–∞ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π —Ç—Ä—É–±–∫–µ</small>
                                </div>
                            </div>
                            
                            <div class="actions">
                                <button class="btn btn-info" onclick="calculateEndCorrection()">
                                    üìê –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —ç–Ω–¥-–∫–æ—Ä—Ä–µ–∫—Ü–∏—é
                                </button>
                                <button class="btn btn-secondary" onclick="autoFillClarinetCalibration()">
                                    üé∫ –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–ª—è –∫–ª–∞—Ä–Ω–µ—Ç–∞
                                </button>
                                <button class="btn btn-secondary" onclick="autoFillSaxCalibration()">
                                    üé∑ –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–ª—è —Å–∞–∫—Å–æ—Ñ–æ–Ω–∞
                                </button>
                            </div>
                            
                            <div id="end-correction-result" class="calibration-result" style="display: none;">
                                <h5>üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h5>
                                <p>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –¥–ª–∏–Ω–∞ (L_eff): <span id="L-eff-value">0</span> –º–º</p>
                                <p>–≠–Ω–¥-–∫–æ—Ä—Ä–µ–∫—Ü–∏—è (Œ¥_m): <span id="delta-m-value">0</span> –º–º</p>
                                <small>–≠—Ç–æ –∫–ª—é—á–µ–≤–æ–µ —á–∏—Å–ª–æ –≤–∫–ª—é—á–∞–µ—Ç –í–°–Æ –∞–∫—É—Å—Ç–∏–∫—É –º—É–Ω–¥—à—Ç—É–∫–∞</small>
                                <button class="btn btn-secondary" onclick="useCalculatedDeltaM()" style="margin-top: 10px;">
                                    ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="mp-delta-m" class="required">–≠–Ω–¥-–∫–æ—Ä—Ä–µ–∫—Ü–∏—è (Œ¥_m), –º–º</label>
                                <div class="input-with-unit">
                                    <input type="number" id="mp-delta-m" step="0.01" min="0" max="200" value="68.0">
                                    <span class="unit">–º–º</span>
                                </div>
                                <small>–ö–ª—é—á–µ–≤–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä! –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤—ã—à–µ –∏–ª–∏ –≤–≤–æ–¥–∏—Ç—Å—è –≤—Ä—É—á–Ω—É—é</small>
                            </div>
                            <div class="form-group">
                                <label for="mp-temperature">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è</label>
                                <div class="input-with-unit">
                                    <input type="number" id="mp-temperature" step="0.1" min="15" max="30" value="20.0">
                                    <span class="unit">¬∞C</span>
                                </div>
                                <small>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–∑–¥—É—Ö–∞ –ø—Ä–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–∏</small>
                            </div>
                            <div class="form-group">
                                <label for="mp-notes">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –ø–æ –º—É–Ω–¥—à—Ç—É–∫—É</label>
                                <textarea id="mp-notes" rows="3" placeholder="–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏, —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ —Ç—Ä–æ—Å—Ç–∏, –∑–∞–º–µ—á–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã..."></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div id="mp-error" class="error"></div>
                    <div id="mp-success" class="success"></div>
                    
                    <div class="actions">
                        <button class="btn btn-primary" onclick="addMouthpiece()">
                            ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º—É–Ω–¥—à—Ç—É–∫ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
                        </button>
                        <button class="btn btn-secondary" onclick="resetMouthpieceForm()">
                            üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Ñ–æ—Ä–º—É
                        </button>
                    </div>
                </div>
                
                <h2>üìã –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º—É–Ω–¥—à—Ç—É–∫–∏</h2>
                <div id="mouthpieces-loading" class="loading">
                    –ó–∞–≥—Ä—É–∑–∫–∞ –º—É–Ω–¥—à—Ç—É–∫–æ–≤...
                </div>
                <div class="components-grid" id="mouthpieces-list">
                    <!-- –°–ø–∏—Å–æ–∫ –º—É–Ω–¥—à—Ç—É–∫–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <!-- –¢—Ä—É–±–∫–∏ -->
            <div id="tubes-tab" class="tab-content">
                <div class="warning">
                    <strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</strong> –î–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∑–≤—É–∫–∞ –≤ –º–∞—Ç–µ—Ä–∏–∞–ª–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–∞–ª–∏–±—Ä–æ–≤–∫—É!
                </div>
                
                <div class="form-section">
                    <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ç—Ä—É–±–∫—É</h3>
                    
                    <div class="parameter-category">
                        <h4>üìè –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="tube-name" class="required">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä—É–±–∫–∏</label>
                                <input type="text" id="tube-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Aluminum_6061_20mm">
                            </div>
                            <div class="form-group">
                                <label for="tube-material" class="required">–ú–∞—Ç–µ—Ä–∏–∞–ª</label>
                                <select id="tube-material">
                                    <option value="aluminum">–ê–ª—é–º–∏–Ω–∏–π</option>
                                    <option value="steel">–°—Ç–∞–ª—å</option>
                                    <option value="bronze">–ë—Ä–æ–Ω–∑–∞</option>
                                    <option value="brass">–õ–∞—Ç—É–Ω—å</option>
                                    <option value="pp">PP (–ü–æ–ª–∏–ø—Ä–æ–ø–∏–ª–µ–Ω)</option>
                                    <option value="petg">PETG</option>
                                    <option value="glass">–°—Ç–µ–∫–ª–æ</option>
                                    <option value="wood">–î–µ—Ä–µ–≤–æ</option>
                                    <option value="rubber">–†–µ–∑–∏–Ω–∞ (–®–ª–∞–Ω–≥)</option>
                                    <option value="pvc">PVC</option>
                                    <option value="carbon">–ö–∞—Ä–±–æ–Ω</option>
                                    <option value="copper">–ú–µ–¥—å</option>
                                    <option value="acrylic">–ê–∫—Ä–∏–ª</option>
                                    <option value="bamboo">–ë–∞–º–±—É–∫</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="tube-length">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –¥–ª–∏–Ω–∞</label>
                                <div class="input-with-unit">
                                    <input type="number" id="tube-length" step="1" value="500">
                                    <span class="unit">–º–º</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="tube-d-in" class="required">–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –¥–∏–∞–º–µ—Ç—Ä (d_in)</label>
                                <div class="input-with-unit">
                                    <input type="number" id="tube-d-in" step="0.01" min="1" max="100" value="20.0">
                                    <span class="unit">–º–º</span>
                                </div>
                                <small>–ì–õ–ê–í–ù–´–ô –ü–ê–†–ê–ú–ï–¢–†! –ò–∑–º–µ—Ä—è—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–æ—á–∫–∞—Ö</small>
                            </div>
                            <div class="form-group">
                                <label for="tube-d-out" class="required">–í–Ω–µ—à–Ω–∏–π –¥–∏–∞–º–µ—Ç—Ä (d_out)</label>
                                <div class="input-with-unit">
                                    <input type="number" id="tube-d-out" step="0.01" min="2" max="110" value="22.0">
                                    <span class="unit">–º–º</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="tube-wall">–¢–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (t_wall)</label>
                                <div class="input-with-unit">
                                    <input type="number" id="tube-wall" step="0.01" min="0.1" max="10" value="1.0" readonly>
                                    <span class="unit">–º–º</span>
                                </div>
                                <small>–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: (d_out - d_in)/2</small>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="tube-taper">–ö–æ–Ω—É—Å–Ω–æ—Å—Ç—å</label>
                                <div class="input-with-unit">
                                    <input type="number" id="tube-taper" step="0.0001" min="-0.1" max="0.1" value="0.0">
                                    <span class="unit">–º–º/–º–º</span>
                                </div>
                                <small>(d_in_–∫–æ–Ω—Ü–∞ - d_in_–Ω–∞—á–∞–ª–∞) / –¥–ª–∏–Ω–∞. 0 = —Ü–∏–ª–∏–Ω–¥—Ä</small>
                            </div>
                            <div class="form-group">
                                <label for="tube-roughness">–®–µ—Ä–æ—Ö–æ–≤–∞—Ç–æ—Å—Ç—å —Å—Ç–µ–Ω–æ–∫</label>
                                <select id="tube-roughness">
                                    <option value="very_smooth">–û—á–µ–Ω—å –≥–ª–∞–¥–∫–∞—è</option>
                                    <option value="smooth">–ì–ª–∞–¥–∫–∞—è</option>
                                    <option value="medium">–°—Ä–µ–¥–Ω—è—è</option>
                                    <option value="rough">–®–µ—Ä–æ—Ö–æ–≤–∞—Ç–∞—è</option>
                                    <option value="very_rough">–û—á–µ–Ω—å —à–µ—Ä–æ—Ö–æ–≤–∞—Ç–∞—è</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="parameter-category">
                        <h4>üéµ –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ —Ç—Ä—É–±–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏!)</h4>
                        
                        <div class="measurement-section">
                            <h4>üîä –ò–∑–º–µ—Ä–µ–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —á–∞—Å—Ç–æ—Ç—ã —Ç—Ä—É–±–∫–∏</h4>
                            <p><strong>–ú–µ—Ç–æ–¥–∏–∫–∞:</strong> –ó–∞–≥–ª—É—à–∏—Ç–µ –æ–±–∞ –∫–æ–Ω—Ü–∞ —Ç—Ä—É–±–∫–∏ –ø–ª–æ—Ç–Ω–æ, –ø–æ—Å—Ç—É—á–∏—Ç–µ –ø–æ –Ω–µ–π –∏ –∏–∑–º–µ—Ä—å—Ç–µ —á–∞—Å—Ç–æ—Ç—É –∑–≤—É–∫–∞ (f_tube). –≠—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –∑–≤—É–∫–∞ –≤ –¥–∞–Ω–Ω–æ–º –º–∞—Ç–µ—Ä–∏–∞–ª–µ.</p>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="tube-f-tube">–ò–∑–º–µ—Ä–µ–Ω–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ (f_tube)</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="tube-f-tube" step="0.1" min="50" max="2000" value="">
                                        <span class="unit">–ì—Ü</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="tube-L-total">–î–ª–∏–Ω–∞ —Ç—Ä—É–±–∫–∏ –ø—Ä–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–∏</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="tube-L-total" step="0.1" value="">
                                        <span class="unit">–º–º</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="tube-temp">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø—Ä–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–∏</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="tube-temp" step="0.1" min="15" max="30" value="20.0">
                                        <span class="unit">¬∞C</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="actions">
                                <button class="btn btn-info" onclick="calculateTubeVelocity()">
                                    üìê –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –∑–≤—É–∫–∞
                                </button>
                            </div>
                            
                            <div id="tube-velocity-result" class="calibration-result" style="display: none;">
                                <h5>üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h5>
                                <p>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∑–≤—É–∫–∞: <span id="v-eff-value">0</span> —Å–º/—Å</p>
                                <p>–û—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –≤–æ–∑–¥—É—Ö—É: <span id="v-ratio-value">0</span></p>
                                <button class="btn btn-secondary" onclick="useCalculatedVelocity()" style="margin-top: 10px;">
                                    ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="tube-v-air">–°–∫–æ—Ä–æ—Å—Ç—å –∑–≤—É–∫–∞ –≤ –≤–æ–∑–¥—É—Ö–µ</label>
                                <div class="input-with-unit">
                                    <input type="number" id="tube-v-air" step="1" value="34300" readonly>
                                    <span class="unit">—Å–º/—Å</span>
                                </div>
                                <small>–ü—Ä–∏ 20¬∞C</small>
                            </div>
                            <div class="form-group">
                                <label for="tube-v-eff">–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∑–≤—É–∫–∞ –≤ —Ç—Ä—É–±–∫–µ</label>
                                <div class="input-with-unit">
                                    <input type="number" id="tube-v-eff" step="1" min="20000" max="40000" value="34300">
                                    <span class="unit">—Å–º/—Å</span>
                                </div>
                                <small>–ò–∑–º–µ—Ä—è–µ—Ç—Å—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π –∏–ª–∏ –æ—Å—Ç–∞–≤–ª—è—Ç—å 34300</small>
                            </div>
                            <div class="form-group">
                                <label for="tube-damping">–î–æ–±—Ä–æ—Ç–Ω–æ—Å—Ç—å (Q)</label>
                                <select id="tube-damping">
                                    <option value="high">–í—ã—Å–æ–∫–∞—è (–∑–≤–æ–Ω–∫–æ –∑–≤—É—á–∏—Ç)</option>
                                    <option value="medium" selected>–°—Ä–µ–¥–Ω—è—è</option>
                                    <option value="low">–ù–∏–∑–∫–∞—è (–±—ã—Å—Ç—Ä–æ –∑–∞—Ç—É—Ö–∞–µ—Ç)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="parameter-category">
                        <h4>üìä –°–ø—Ä–∞–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</h4>
                        <table class="parameter-table">
                            <thead>
                                <tr>
                                    <th>–ú–∞—Ç–µ—Ä–∏–∞–ª</th>
                                    <th>–ü–ª–æ—Ç–Ω–æ—Å—Ç—å (–≥/—Å–º¬≥)</th>
                                    <th>–°–∫–æ—Ä–æ—Å—Ç—å –∑–≤—É–∫–∞ (–º/—Å)</th>
                                    <th>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –∫–æ—ç—Ñ.</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>–ê–ª—é–º–∏–Ω–∏–π</td>
                                    <td>2.70</td>
                                    <td>6420</td>
                                    <td>0.17 –º–º/¬∞C</td>
                                    <td><button class="btn btn-secondary" onclick="fillMaterialData('aluminum')" style="padding: 2px 8px;">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button></td>
                                </tr>
                                <tr>
                                    <td>–°—Ç–∞–ª—å</td>
                                    <td>7.85</td>
                                    <td>5960</td>
                                    <td>0.11 –º–º/¬∞C</td>
                                    <td><button class="btn btn-secondary" onclick="fillMaterialData('steel')" style="padding: 2px 8px;">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button></td>
                                </tr>
                                <tr>
                                    <td>–õ–∞—Ç—É–Ω—å</td>
                                    <td>8.50</td>
                                    <td>4700</td>
                                    <td>0.18 –º–º/¬∞C</td>
                                    <td><button class="btn btn-secondary" onclick="fillMaterialData('brass')" style="padding: 2px 8px;">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button></td>
                                </tr>
                                <tr>
                                    <td>–ë—Ä–æ–Ω–∑–∞</td>
                                    <td>8.80</td>
                                    <td>4500</td>
                                    <td>0.18 –º–º/¬∞C</td>
                                    <td><button class="btn btn-secondary" onclick="fillMaterialData('bronze')" style="padding: 2px 8px;">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button></td>
                                </tr>
                                <tr>
                                    <td>PP (–ü–æ–ª–∏–ø—Ä–æ–ø–∏–ª–µ–Ω)</td>
                                    <td>0.90</td>
                                    <td>2700</td>
                                    <td>0.15 –º–º/¬∞C</td>
                                    <td><button class="btn btn-secondary" onclick="fillMaterialData('pp')" style="padding: 2px 8px;">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button></td>
                                </tr>
                                <tr>
                                    <td>PETG</td>
                                    <td>1.27</td>
                                    <td>2400</td>
                                    <td>0.12 –º–º/¬∞C</td>
                                    <td><button class="btn btn-secondary" onclick="fillMaterialData('petg')" style="padding: 2px 8px;">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button></td>
                                </tr>
                                <tr>
                                    <td>–°—Ç–µ–∫–ª–æ</td>
                                    <td>2.50</td>
                                    <td>5800</td>
                                    <td>0.09 –º–º/¬∞C</td>
                                    <td><button class="btn btn-secondary" onclick="fillMaterialData('glass')" style="padding: 2px 8px;">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button></td>
                                </tr>
                                <tr>
                                    <td>–î–µ—Ä–µ–≤–æ</td>
                                    <td>0.60</td>
                                    <td>4000</td>
                                    <td>0.05 –º–º/¬∞C</td>
                                    <td><button class="btn btn-secondary" onclick="fillMaterialData('wood')" style="padding: 2px 8px;">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button></td>
                                </tr>
                                <tr>
                                    <td>–†–µ–∑–∏–Ω–∞ (–®–ª–∞–Ω–≥)</td>
                                    <td>1.10</td>
                                    <td>1500</td>
                                    <td>0.25 –º–º/¬∞C</td>
                                    <td><button class="btn btn-secondary" onclick="fillMaterialData('rubber')" style="padding: 2px 8px;">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button></td>
                                </tr>
                                <tr>
                                    <td>PVC</td>
                                    <td>1.38</td>
                                    <td>2200</td>
                                    <td>0.10 –º–º/¬∞C</td>
                                    <td><button class="btn btn-secondary" onclick="fillMaterialData('pvc')" style="padding: 2px 8px;">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="tube-error" class="error"></div>
                    <div id="tube-success" class="success"></div>
                    
                    <div class="actions">
                        <button class="btn btn-primary" onclick="addTube()">
                            ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä—É–±–∫—É —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
                        </button>
                        <button class="btn btn-secondary" onclick="resetTubeForm()">
                            üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Ñ–æ—Ä–º—É
                        </button>
                    </div>
                </div>
                
                <h2>üìã –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç—Ä—É–±–∫–∏</h2>
                <div id="tubes-loading" class="loading">
                    –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä—É–±–æ–∫...
                </div>
                <div class="components-grid" id="tubes-list">
                    <!-- –°–ø–∏—Å–æ–∫ —Ç—Ä—É–±–æ–∫ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            
            <!-- –†–∞—Å—Ç—Ä—É–±—ã -->
            <div id="bells-tab" class="tab-content">
                <div class="warning">
                    <strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</strong> –î–ª—è —Ç–æ—á–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∞–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è —Å —Ä–∞—Å—Ç—Ä—É–±–æ–º –∏ –±–µ–∑.
                </div>
                
                <div class="form-section">
                    <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ä–∞—Å—Ç—Ä—É–±</h3>
                    
                    <div class="parameter-category">
                        <h4>üìè –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bell-name" class="required">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞—Å—Ç—Ä—É–±–∞</label>
                                <input type="text" id="bell-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Bell_Alto_Sax_Style">
                            </div>
                            <div class="form-group">
                                <label for="bell-type" class="required">–¢–∏–ø —Ä–∞—Å—Ç—Ä—É–±–∞</label>
                                <select id="bell-type">
                                    <option value="flare">–†–∞—Å—à–∏—Ä—è—é—â–∏–π—Å—è –∫–æ–Ω—É—Å</option>
                                    <option value="straight">–ü—Ä—è–º–æ–π (—Ü–∏–ª–∏–Ω–¥—Ä)</option>
                                    <option value="none">–ë–µ–∑ —Ä–∞—Å—Ç—Ä—É–±–∞</option>
                                    <option value="exponential">–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π</option>
                                    <option value="parabolic">–ü–∞—Ä–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π</option>
                                    <option value="step">–°—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π</option>
                                    <option value="trumpet">–¢—Ä—É–±–Ω—ã–π —Ç–∏–ø</option>
                                    <option value="flute">–§–ª–µ–π—Ç–æ–≤—ã–π —Ä–∞—Å—Ç—Ä—É–±</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="bell-material">–ú–∞—Ç–µ—Ä–∏–∞–ª</label>
                                <select id="bell-material">
                                    <option value="same">–ö–∞–∫ —É —Ç—Ä—É–±–∫–∏</option>
                                    <option value="metal">–ú–µ—Ç–∞–ª–ª</option>
                                    <option value="brass">–õ–∞—Ç—É–Ω—å</option>
                                    <option value="plastic">–ü–ª–∞—Å—Ç–∏–∫</option>
                                    <option value="wood">–î–µ—Ä–µ–≤–æ</option>
                                    <option value="acrylic">–ê–∫—Ä–∏–ª</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bell-d-in" class="required">–î–∏–∞–º–µ—Ç—Ä –≤—Ö–æ–¥–∞ (d_bell_in)</label>
                                <div class="input-with-unit">
                                    <input type="number" id="bell-d-in" step="0.01" min="5" max="100" value="28.0">
                                    <span class="unit">–º–º</span>
                                </div>
                                <small>–î–∏–∞–º–µ—Ç—Ä –≤ –Ω–∞—á–∞–ª–µ —Ä–∞—Å—Ç—Ä—É–±–∞ (–≥–¥–µ –∫—Ä–µ–ø–∏—Ç—Å—è –∫ —Ç—Ä—É–±–∫–µ)</small>
                            </div>
                            <div class="form-group">
                                <label for="bell-d-out">–î–∏–∞–º–µ—Ç—Ä –≤—ã—Ö–æ–¥–∞ (d_bell_out)</label>
                                <div class="input-with-unit">
                                    <input type="number" id="bell-d-out" step="0.01" min="10" max="200" value="80.0">
                                    <span class="unit">–º–º</span>
                                </div>
                                <small>–î–∏–∞–º–µ—Ç—Ä –Ω–∞ –≤—ã—Ö–æ–¥–µ —Ä–∞—Å—Ç—Ä—É–±–∞</small>
                            </div>
                            <div class="form-group">
                                <label for="bell-length" class="required">–î–ª–∏–Ω–∞ —Ä–∞—Å—Ç—Ä—É–±–∞ (L_bell)</label>
                                <div class="input-with-unit">
                                    <input type="number" id="bell-length" step="0.1" min="10" max="500" value="150.0">
                                    <span class="unit">–º–º</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bell-expansion">–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è</label>
                                <div class="input-with-unit">
                                    <input type="number" id="bell-expansion" step="0.01" min="1.0" max="5.0" value="2.86" readonly>
                                    <span class="unit">d_out/d_in</span>
                                </div>
                                <small>–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</small>
                            </div>
                            <div class="form-group">
                                <label for="bell-angle">–£–≥–æ–ª —Ä–∞—Å–∫—Ä—ã—Ç–∏—è</label>
                                <div class="input-with-unit">
                                    <input type="number" id="bell-angle" step="0.1" min="0" max="90" value="15.0" readonly>
                                    <span class="unit">¬∞</span>
                                </div>
                                <small>–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</small>
                            </div>
                            <div class="form-group">
                                <label for="bell-wall">–¢–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏</label>
                                <div class="input-with-unit">
                                    <input type="number" id="bell-wall" step="0.1" min="0.1" max="10" value="1.5">
                                    <span class="unit">–º–º</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>–ü—Ä–æ—Ñ–∏–ª—å –∫—Ä–∏–≤–æ–π (–∏–∑–º–µ—Ä–∏—Ç—å –¥–∏–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –∫–∞–∂–¥—ã–µ 10–º–º)</label>
                            <textarea id="bell-profile" rows="3" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 0–º–º: 28–º–º, 50–º–º: 54–º–º, 100–º–º: 72–º–º, 150–º–º: 80–º–º"></textarea>
                            <small>–ò–∑–º–µ—Ä—å—Ç–µ –∏ –∑–∞–ø–∏—à–∏—Ç–µ –¥–∏–∞–º–µ—Ç—Ä—ã –ø–æ –¥–ª–∏–Ω–µ —Ä–∞—Å—Ç—Ä—É–±–∞</small>
                        </div>
                    </div>
                    
                    <div class="parameter-category">
                        <h4>üéµ –ê–∫—É—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</h4>
                        
                        <div class="measurement-section">
                            <h4>üîä –ò–∑–º–µ—Ä–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–π –¥–ª–∏–Ω—ã (ŒîL_bell)</h4>
                            <p><strong>–ú–µ—Ç–æ–¥–∏–∫–∞:</strong> –ò–∑–º–µ—Ä—å—Ç–µ –æ—Å–Ω–æ–≤–Ω—É—é —á–∞—Å—Ç–æ—Ç—É —Ç—Ä—É–±–∫–∏ –±–µ–∑ —Ä–∞—Å—Ç—Ä—É–±–∞ (f_no_bell), –∑–∞—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞—Å—Ç—Ä—É–± –∏ –∏–∑–º–µ—Ä—å—Ç–µ —á–∞—Å—Ç–æ—Ç—É (f_with_bell).</p>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="bell-f-no">–ß–∞—Å—Ç–æ—Ç–∞ –±–µ–∑ —Ä–∞—Å—Ç—Ä—É–±–∞ (f_no_bell)</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="bell-f-no" step="0.1" value="">
                                        <span class="unit">–ì—Ü</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="bell-f-with">–ß–∞—Å—Ç–æ—Ç–∞ —Å —Ä–∞—Å—Ç—Ä—É–±–æ–º (f_with_bell)</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="bell-f-with" step="0.1" value="">
                                        <span class="unit">–ì—Ü</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="bell-v-sound">–°–∫–æ—Ä–æ—Å—Ç—å –∑–≤—É–∫–∞ –≤ –≤–æ–∑–¥—É—Ö–µ</label>
                                    <div class="input-with-unit">
                                        <input type="number" id="bell-v-sound" step="1" value="34300">
                                        <span class="unit">—Å–º/—Å</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="actions">
                                <button class="btn btn-info" onclick="calculateBellEffect()">
                                    üìê –†–∞—Å—Å—á–∏—Ç–∞—Ç—å ŒîL_bell
                                </button>
                            </div>
                            
                            <div id="bell-effect-result" class="calibration-result" style="display: none;">
                                <h5>üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h5>
                                <p>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –¥–æ–±–∞–≤–ª–µ–Ω–Ω–∞—è –¥–ª–∏–Ω–∞: <span id="delta-L-value">0</span> –º–º</p>
                                <p>–û–±—ã—á–Ω–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ (—Ä–∞—Å—Ç—Ä—É–± —É–∫–æ—Ä–∞—á–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –¥–ª–∏–Ω—É)</p>
                                <button class="btn btn-secondary" onclick="useCalculatedDeltaL()" style="margin-top: 10px;">
                                    ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bell-delta-L">–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –¥–æ–±–∞–≤–ª–µ–Ω–Ω–∞—è –¥–ª–∏–Ω–∞ (ŒîL_bell)</label>
                                <div class="input-with-unit">
                                    <input type="number" id="bell-delta-L" step="0.1" min="-50" max="50" value="-12.5">
                                    <span class="unit">–º–º</span>
                                </div>
                                <small>–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ = —É–∫–æ—Ä–∞—á–∏–≤–∞–µ—Ç, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ = —É–¥–ª–∏–Ω—è–µ—Ç</small>
                            </div>
                            <div class="form-group">
                                <label for="bell-acoustic">–ê–∫—É—Å—Ç–∏—á–µ—Å–∫–æ–µ –≤–ª–∏—è–Ω–∏–µ</label>
                                <select id="bell-acoustic">
                                    <option value="strong">–°–∏–ª—å–Ω–æ–µ (—Å–∏–ª—å–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç —Å—Ç—Ä–æ–π)</option>
                                    <option value="medium" selected>–°—Ä–µ–¥–Ω–µ–µ</option>
                                    <option value="weak">–°–ª–∞–±–æ–µ</option>
                                    <option value="none">–ù–µ –≤–ª–∏—è–µ—Ç</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div id="bell-error" class="error"></div>
                    <div id="bell-success" class="success"></div>
                    
                    <div class="actions">
                        <button class="btn btn-primary" onclick="addBell()">
                            ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å—Ç—Ä—É–± —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
                        </button>
                        <button class="btn btn-secondary" onclick="resetBellForm()">
                            üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Ñ–æ—Ä–º—É
                        </button>
                        <button class="btn btn-info" onclick="fillSaxBellExample()">
                            üé∑ –ü—Ä–∏–º–µ—Ä: –∞–ª—å—Ç-—Å–∞–∫—Å–æ—Ñ–æ–Ω
                        </button>
                    </div>
                </div>
                
                <h2>üìã –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ä–∞—Å—Ç—Ä—É–±—ã</h2>
                <div id="bells-loading" class="loading">
                    –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–∞—Å—Ç—Ä—É–±–æ–≤...
                </div>
                <div class="components-grid" id="bells-list">
                    <!-- –°–ø–∏—Å–æ–∫ —Ä–∞—Å—Ç—Ä—É–±–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // –û–±—ä–µ–∫—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
        let selectedComponents = {
            mouthpiece: null,
            tube: null,
            bell: null
        };

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–∞–º–∏
        document.addEventListener('DOMContentLoaded', function() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
            loadMouthpieces();
            loadTubes();
            loadBells();
            
            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ç–∞–±–æ–≤
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ç–∞–±—ã
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                    document.querySelectorAll('.tab-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞–±
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                    this.classList.add('active');
                });
            });
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç —Ç–æ–ª—â–∏–Ω—ã —Å—Ç–µ–Ω–∫–∏ –¥–ª—è —Ç—Ä—É–±–∫–∏
            document.getElementById('tube-d-in').addEventListener('input', updateTubeWall);
            document.getElementById('tube-d-out').addEventListener('input', updateTubeWall);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏ —É–≥–ª–∞ –¥–ª—è —Ä–∞—Å—Ç—Ä—É–±–∞
            document.getElementById('bell-d-in').addEventListener('input', updateBellCalculations);
            document.getElementById('bell-d-out').addEventListener('input', updateBellCalculations);
            document.getElementById('bell-length').addEventListener('input', updateBellCalculations);
        });
        
        function updateTubeWall() {
            const dIn = parseFloat(document.getElementById('tube-d-in').value) || 0;
            const dOut = parseFloat(document.getElementById('tube-d-out').value) || 0;
            const wallThickness = (dOut - dIn) / 2;
            document.getElementById('tube-wall').value = wallThickness.toFixed(2);
        }
        
        function updateBellCalculations() {
            const dIn = parseFloat(document.getElementById('bell-d-in').value) || 0;
            const dOut = parseFloat(document.getElementById('bell-d-out').value) || 0;
            const length = parseFloat(document.getElementById('bell-length').value) || 0;
            
            if (dIn > 0 && dOut > 0) {
                const expansion = dOut / dIn;
                document.getElementById('bell-expansion').value = expansion.toFixed(2);
                
                if (length > 0) {
                    // –£–≥–æ–ª —Ä–∞—Å–∫—Ä—ã—Ç–∏—è: arctan((d_out - d_in)/2 / length)
                    const halfDiff = (dOut - dIn) / 2;
                    const angle = Math.atan(halfDiff / length) * (180 / Math.PI);
                    document.getElementById('bell-angle').value = angle.toFixed(1);
                }
            }
        }
        
        // ========== –ú–£–ù–î–®–¢–£–ö–ò ==========
        
        function calculateEndCorrection() {
            const L_calib = parseFloat(document.getElementById('mp-L-calib').value) || 400;
            const d_calib = parseFloat(document.getElementById('mp-d-calib').value) || 13;
            const f_meas = parseFloat(document.getElementById('mp-f-meas').value);
            
            if (!f_meas || f_meas <= 0) {
                showError('mp-error', '–í–≤–µ–¥–∏—Ç–µ –∏–∑–º–µ—Ä–µ–Ω–Ω—É—é —á–∞—Å—Ç–æ—Ç—É (f_meas)');
                return;
            }
            
            // –°–∫–æ—Ä–æ—Å—Ç—å –∑–≤—É–∫–∞ –ø—Ä–∏ 20¬∞C –≤ —Å–º/—Å
            const v = 34300;
            
            // –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –¥–ª–∏–Ω–∞: L_eff = v / (2 * f_meas)
            const L_eff = v / (2 * f_meas); // –≤ —Å–º
            const L_eff_mm = L_eff * 10; // –ø–µ—Ä–µ–≤–æ–¥–∏–º –≤ –º–º
            
            // –≠–Ω–¥-–∫–æ—Ä—Ä–µ–∫—Ü–∏—è: Œ¥_m = (L_eff - L_calib) / 2
            const delta_m = (L_eff_mm - L_calib) / 2;
            
            document.getElementById('L-eff-value').textContent = L_eff_mm.toFixed(1);
            document.getElementById('delta-m-value').textContent = delta_m.toFixed(1);
            document.getElementById('end-correction-result').style.display = 'block';
        }
        
        function useCalculatedDeltaM() {
            const deltaM = parseFloat(document.getElementById('delta-m-value').textContent);
            document.getElementById('mp-delta-m').value = deltaM;
            showSuccess('mp-success', `–≠–Ω–¥-–∫–æ—Ä—Ä–µ–∫—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: ${deltaM.toFixed(1)}–º–º`);
        }
        
        function autoFillClarinetCalibration() {
            document.getElementById('mp-L-calib').value = '400.0';
            document.getElementById('mp-d-calib').value = '13.0';
            document.getElementById('mp-f-meas').value = '320.0';
            calculateEndCorrection();
        }
        
        function autoFillSaxCalibration() {
            document.getElementById('mp-L-calib').value = '400.0';
            document.getElementById('mp-d-calib').value = '17.0';
            document.getElementById('mp-f-meas').value = '280.0';
            calculateEndCorrection();
        }
        
        async function loadMouthpieces() {
            try {
                const response = await fetch('/api/mouthpieces');
                const data = await response.json();
                
                document.getElementById('mouthpieces-loading').style.display = 'none';
                const container = document.getElementById('mouthpieces-list');
                container.innerHTML = '';
                
                if (data.mouthpieces && data.mouthpieces.length > 0) {
                    data.mouthpieces.forEach(mp => {
                        const card = createMouthpieceCard(mp);
                        container.appendChild(card);
                    });
                } else {
                    container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">–ú—É–Ω–¥—à—Ç—É–∫–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º—É–Ω–¥—à—Ç—É–∫–æ–≤:', error);
                document.getElementById('mouthpieces-loading').innerHTML = 
                    '<p style="color: red;">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</p>';
            }
        }
        
        function createMouthpieceCard(mp) {
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ—Ä–µ–Ω–∏–π
            let measurementStatus = 'status-required';
            let statusText = '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
            
            if (mp.delta_m && mp.delta_m > 0) {
                measurementStatus = 'status-complete';
                statusText = '–ò–∑–º–µ—Ä–µ–Ω–æ';
            } else if (mp.L_m && mp.d_tip) {
                measurementStatus = 'status-partial';
                statusText = '–ß–∞—Å—Ç–∏—á–Ω–æ';
            }
            
            const card = document.createElement('div');
            card.className = 'component-card';
            card.dataset.id = mp.id;
            card.dataset.type = 'mouthpieces';
            
            card.innerHTML = `
                <div class="measurement-status ${measurementStatus}">${statusText}</div>
                <h3>${mp.name}</h3>
                <div class="component-param">
                    <span class="param-label">–¢–∏–ø:</span>
                    <span class="param-value">${getMouthpieceTypeName(mp.type)}</span>
                </div>
                <div class="component-param">
                    <span class="param-label">–≠–Ω–¥-–∫–æ—Ä—Ä–µ–∫—Ü–∏—è:</span>
                    <span class="param-value">${mp.delta_m ? mp.delta_m.toFixed(1) + ' –º–º' : '–ù–µ –∏–∑–º–µ—Ä–µ–Ω–æ'}</span>
                </div>
                <div class="component-param">
                    <span class="param-label">d_tip / d_out:</span>
                    <span class="param-value">${mp.d_tip ? mp.d_tip.toFixed(1) : '?'} / ${mp.d_out ? mp.d_out.toFixed(1) : '?'} –º–º</span>
                </div>
                <div class="component-param">
                    <span class="param-label">L_m:</span>
                    <span class="param-value">${mp.L_m ? mp.L_m.toFixed(1) + ' –º–º' : '?'}</span>
                </div>
                <div class="component-param">
                    <span class="param-label">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å:</span>
                    <span class="param-value">${mp.brand || '-'}</span>
                </div>
                <div style="margin-top: 15px; display: flex; gap: 10px; justify-content: flex-end;">
                    <button onclick="selectComponent(${mp.id}, 'mouthpieces', '${mp.name}')" 
                            class="btn btn-secondary" 
                            style="padding: 5px 10px; font-size: 14px;">
                        ‚úÖ –í—ã–±—Ä–∞—Ç—å
                    </button>
                    <button onclick="deleteComponent('mouthpieces', ${mp.id})" 
                            class="btn btn-danger" 
                            style="padding: 5px 10px; font-size: 14px;">
                        –£–¥–∞–ª–∏—Ç—å
                    </button>
                </div>
            `;
            return card;
        }
        
        function getMouthpieceTypeName(type) {
            const names = {
                'clarinet': '–ö–ª–∞—Ä–Ω–µ—Ç',
                'alto_sax': '–ê–ª—å—Ç —Å–∞–∫—Å–æ—Ñ–æ–Ω',
                'tenor_sax': '–¢–µ–Ω–æ—Ä —Å–∞–∫—Å–æ—Ñ–æ–Ω',
                'soprano_sax': '–°–æ–ø—Ä–∞–Ω–æ —Å–∞–∫—Å–æ—Ñ–æ–Ω',
                'bass_clarinet': '–ë–∞—Å—Å –∫–ª–∞—Ä–Ω–µ—Ç',
                'native': '–ù–∞—Ç–∏–≤–Ω—ã–π',
                'flute': '–§–ª–µ–π—Ç–∞',
                'recorder': '–†–µ–∫–æ—Ä–¥–µ—Ä'
            };
            return names[type] || type;
        }
        
        async function addMouthpiece() {
            const data = {
                name: document.getElementById('mp-name').value.trim(),
                type: document.getElementById('mp-type').value,
                brand: document.getElementById('mp-brand').value.trim(),
                d_tip: parseFloat(document.getElementById('mp-d-tip').value),
                d_out: parseFloat(document.getElementById('mp-d-out').value),
                L_m: parseFloat(document.getElementById('mp-L-m').value),
                L_cyl: parseFloat(document.getElementById('mp-L-cyl').value) || 0,
                baffle: document.getElementById('mp-baffle').value,
                chamber_depth: parseFloat(document.getElementById('mp-chamber').value),
                delta_m: parseFloat(document.getElementById('mp-delta-m').value),
                temperature: parseFloat(document.getElementById('mp-temperature').value),
                notes: document.getElementById('mp-notes').value.trim(),
                
                // –î–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
                L_calib: parseFloat(document.getElementById('mp-L-calib').value),
                d_calib: parseFloat(document.getElementById('mp-d-calib').value),
                f_meas: parseFloat(document.getElementById('mp-f-meas').value)
            };
            
            if (!data.name) {
                showError('mp-error', '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º—É–Ω–¥—à—Ç—É–∫–∞');
                return;
            }
            
            if (!data.d_tip || !data.d_out) {
                showError('mp-error', '–í–≤–µ–¥–∏—Ç–µ –¥–∏–∞–º–µ—Ç—Ä—ã –º—É–Ω–¥—à—Ç—É–∫–∞');
                return;
            }
            
            try {
                const response = await fetch('/api/mouthpieces', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    showSuccess('mp-success', `–ú—É–Ω–¥—à—Ç—É–∫ "${data.name}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω!`);
                    resetMouthpieceForm();
                    loadMouthpieces();
                } else {
                    showError('mp-error', result.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏');
                }
            } catch (error) {
                showError('mp-error', `–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`);
            }
        }
        
        function resetMouthpieceForm() {
            document.getElementById('mp-name').value = '';
            document.getElementById('mp-type').value = 'clarinet';
            document.getElementById('mp-brand').value = '';
            document.getElementById('mp-d-tip').value = '13.5';
            document.getElementById('mp-d-out').value = '14.7';
            document.getElementById('mp-L-m').value = '75.0';
            document.getElementById('mp-L-cyl').value = '0.0';
            document.getElementById('mp-baffle').value = 'low_straight';
            document.getElementById('mp-chamber').value = '15.0';
            document.getElementById('mp-delta-m').value = '68.0';
            document.getElementById('mp-temperature').value = '20.0';
            document.getElementById('mp-notes').value = '';
            document.getElementById('mp-L-calib').value = '400.0';
            document.getElementById('mp-d-calib').value = '13.0';
            document.getElementById('mp-f-meas').value = '320.0';
            hideMessages('mp');
            document.getElementById('end-correction-result').style.display = 'none';
        }
        
        // ========== –¢–†–£–ë–ö–ò ==========
        
        function calculateTubeVelocity() {
            const f_tube = parseFloat(document.getElementById('tube-f-tube').value);
            const L_total = parseFloat(document.getElementById('tube-L-total').value);
            
            if (!f_tube || f_tube <= 0) {
                showError('tube-error', '–í–≤–µ–¥–∏—Ç–µ –∏–∑–º–µ—Ä–µ–Ω–Ω—É—é —á–∞—Å—Ç–æ—Ç—É (f_tube)');
                return;
            }
            
            if (!L_total || L_total <= 0) {
                showError('tube-error', '–í–≤–µ–¥–∏—Ç–µ –¥–ª–∏–Ω—É —Ç—Ä—É–±–∫–∏ –ø—Ä–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–∏');
                return;
            }
            
            // –î–ª—è —Ç—Ä—É–±—ã —Å –æ–±–æ–∏–º–∏ –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –∫–æ–Ω—Ü–∞–º–∏: f_tube = (v_eff * n) / (2 * L_total)
            // –≥–¥–µ n=1 –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–æ–Ω–∞, L_total –≤ —Å–º
            const L_total_cm = L_total / 10; // –ø–µ—Ä–µ–≤–æ–¥–∏–º –≤ —Å–º
            const v_eff = 2 * L_total_cm * f_tube; // –≤ —Å–º/—Å
            
            const v_air = 34300; // —Å–∫–æ—Ä–æ—Å—Ç—å –∑–≤—É–∫–∞ –≤ –≤–æ–∑–¥—É—Ö–µ –ø—Ä–∏ 20¬∞C
            const ratio = v_eff / v_air;
            
            document.getElementById('v-eff-value').textContent = v_eff.toFixed(0);
            document.getElementById('v-ratio-value').textContent = ratio.toFixed(3);
            document.getElementById('tube-velocity-result').style.display = 'block';
        }
        
        function useCalculatedVelocity() {
            const vEff = parseFloat(document.getElementById('v-eff-value').textContent);
            document.getElementById('tube-v-eff').value = vEff;
            showSuccess('tube-success', `–°–∫–æ—Ä–æ—Å—Ç—å –∑–≤—É–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: ${vEff.toFixed(0)} —Å–º/—Å`);
        }
        
        function fillMaterialData(material) {
            const data = {
                'aluminum': { name: '–ê–ª—é–º–∏–Ω–∏–π 6061', d_in: 20.0, d_out: 22.0, v_eff: 33500 },
                'steel': { name: '–°—Ç–∞–ª—å 304', d_in: 19.0, d_out: 21.0, v_eff: 33000 },
                'brass': { name: '–õ–∞—Ç—É–Ω—å', d_in: 20.0, d_out: 22.0, v_eff: 32000 },
                'bronze': { name: '–ë—Ä–æ–Ω–∑–∞', d_in: 20.0, d_out: 22.0, v_eff: 31500 },
                'pp': { name: 'PP —Ç—Ä—É–±–∫–∞', d_in: 20.0, d_out: 22.0, v_eff: 28000 },
                'petg': { name: 'PETG', d_in: 20.0, d_out: 22.0, v_eff: 27000 },
                'glass': { name: '–°—Ç–µ–∫–ª–æ', d_in: 20.0, d_out: 22.0, v_eff: 34000 },
                'wood': { name: '–î–µ—Ä–µ–≤–æ (–∫–ª–µ–Ω)', d_in: 20.0, d_out: 22.0, v_eff: 31000 },
                'rubber': { name: '–†–µ–∑–∏–Ω–æ–≤—ã–π —à–ª–∞–Ω–≥', d_in: 19.0, d_out: 22.0, v_eff: 25000 },
                'pvc': { name: 'PVC', d_in: 20.0, d_out: 22.0, v_eff: 29000 }
            };
            
            if (data[material]) {
                document.getElementById('tube-name').value = data[material].name;
                document.getElementById('tube-material').value = material;
                document.getElementById('tube-d-in').value = data[material].d_in;
                document.getElementById('tube-d-out').value = data[material].d_out;
                document.getElementById('tube-v-eff').value = data[material].v_eff;
                updateTubeWall();
                showSuccess('tube-success', `–î–∞–Ω–Ω—ã–µ –¥–ª—è ${material} –∑–∞–≥—Ä—É–∂–µ–Ω—ã`);
            }
        }
        
        async function loadTubes() {
            try {
                const response = await fetch('/api/tubes');
                const data = await response.json();
                
                document.getElementById('tubes-loading').style.display = 'none';
                const container = document.getElementById('tubes-list');
                container.innerHTML = '';
                
                if (data.tubes && data.tubes.length > 0) {
                    data.tubes.forEach(tube => {
                        const card = createTubeCard(tube);
                        container.appendChild(card);
                    });
                } else {
                    container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">–¢—Ä—É–±–æ–∫ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç—Ä—É–±–æ–∫:', error);
                document.getElementById('tubes-loading').innerHTML = 
                    '<p style="color: red;">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</p>';
            }
        }
        
        function createTubeCard(tube) {
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
            let measurementStatus = 'status-required';
            let statusText = '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
            
            if (tube.v_eff && tube.v_eff !== 34300) {
                measurementStatus = 'status-complete';
                statusText = '–ö–∞–ª–∏–±—Ä–æ–≤–∞–Ω–æ';
            } else if (tube.d_in && tube.d_out) {
                measurementStatus = 'status-partial';
                statusText = '–ß–∞—Å—Ç–∏—á–Ω–æ';
            }
            
            const wallThickness = tube.wall_thickness || ((tube.d_out - tube.d_in) / 2);
            
            const card = document.createElement('div');
            card.className = 'component-card';
            card.dataset.id = tube.id;
            card.dataset.type = 'tubes';
            
            card.innerHTML = `
                <div class="measurement-status ${measurementStatus}">${statusText}</div>
                <h3>${tube.name}</h3>
                <div class="component-param">
                    <span class="param-label">–ú–∞—Ç–µ—Ä–∏–∞–ª:</span>
                    <span class="param-value">${getMaterialName(tube.material)}</span>
                </div>
                <div class="component-param">
                    <span class="param-label">–î–∏–∞–º–µ—Ç—Ä:</span>
                    <span class="param-value">${tube.d_in ? tube.d_in.toFixed(1) : '?'} –º–º</span>
                </div>
                <div class="component-param">
                    <span class="param-label">–¢–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏:</span>
                    <span class="param-value">${wallThickness.toFixed(1)} –º–º</span>
                </div>
                <div class="component-param">
                    <span class="param-label">V_eff:</span>
                    <span class="param-value">${tube.v_eff ? (tube.v_eff / 1000).toFixed(1) + ' –º/—Å' : '343 –º/—Å'}</span>
                </div>
                <div class="component-param">
                    <span class="param-label">–ö–æ–Ω—É—Å–Ω–æ—Å—Ç—å:</span>
                    <span class="param-value">${tube.taper ? tube.taper.toFixed(4) : '0.0000'}</span>
                </div>
                <div style="margin-top: 15px; display: flex; gap: 10px; justify-content: flex-end;">
                    <button onclick="selectComponent(${tube.id}, 'tubes', '${tube.name}')" 
                            class="btn btn-secondary" 
                            style="padding: 5px 10px; font-size: 14px;">
                        ‚úÖ –í—ã–±—Ä–∞—Ç—å
                    </button>
                    <button onclick="deleteComponent('tubes', ${tube.id})" 
                            class="btn btn-danger" 
                            style="padding: 5px 10px; font-size: 14px;">
                        –£–¥–∞–ª–∏—Ç—å
                    </button>
                </div>
            `;
            
            return card;
        }
        
        function getMaterialName(material) {
            const names = {
                'aluminum': '–ê–ª—é–º–∏–Ω–∏–π',
                'steel': '–°—Ç–∞–ª—å',
                'bronze': '–ë—Ä–æ–Ω–∑–∞',
                'brass': '–õ–∞—Ç—É–Ω—å',
                'pp': 'PP',
                'petg': 'PETG',
                'glass': '–°—Ç–µ–∫–ª–æ',
                'wood': '–î–µ—Ä–µ–≤–æ',
                'rubber': '–†–µ–∑–∏–Ω–∞',
                'pvc': 'PVC',
                'carbon': '–ö–∞—Ä–±–æ–Ω',
                'copper': '–ú–µ–¥—å',
                'acrylic': '–ê–∫—Ä–∏–ª',
                'bamboo': '–ë–∞–º–±—É–∫'
            };
            return names[material] || material;
        }
        
       async function addTube() {
            const data = {
                name: document.getElementById('tube-name').value.trim(),
                material: document.getElementById('tube-material').value,
                length: parseFloat(document.getElementById('tube-length').value) || 500,
                d_in: parseFloat(document.getElementById('tube-d-in').value),
                d_out: parseFloat(document.getElementById('tube-d-out').value),
                wall_thickness: parseFloat(document.getElementById('tube-wall').value),
                taper: parseFloat(document.getElementById('tube-taper').value) || 0,
                form: 'round',
                roughness: document.getElementById('tube-roughness').value,
                v_air: parseFloat(document.getElementById('tube-v-air').value),
                v_eff: parseFloat(document.getElementById('tube-v-eff').value),
                damping: document.getElementById('tube-damping').value,
                f_tube: parseFloat(document.getElementById('tube-f-tube').value) || null,
                L_total: parseFloat(document.getElementById('tube-L-total').value) || null,
                density: null,
                thermal_coeff: null
            };
            
            if (!data.name) {
                showError('tube-error', '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä—É–±–∫–∏');
                return;
            }
            
            if (!data.d_in || !data.d_out) {
                showError('tube-error', '–í–≤–µ–¥–∏—Ç–µ –¥–∏–∞–º–µ—Ç—Ä—ã —Ç—Ä—É–±–∫–∏');
                return;
            }
            
            try {
                const response = await fetch('/api/tubes', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    showSuccess('tube-success', `–¢—Ä—É–±–∫–∞ "${data.name}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!`);
                    resetTubeForm();
                    loadTubes();
                } else {
                    showError('tube-error', result.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏');
                }
            } catch (error) {
                showError('tube-error', `–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`);
            }
        }
        
        function resetTubeForm() {
            document.getElementById('tube-name').value = '';
            document.getElementById('tube-material').value = 'aluminum';
            document.getElementById('tube-length').value = '500';
            document.getElementById('tube-d-in').value = '20.0';
            document.getElementById('tube-d-out').value = '22.0';
            document.getElementById('tube-taper').value = '0.0';
            document.getElementById('tube-roughness').value = 'smooth';
            document.getElementById('tube-v-air').value = '34300';
            document.getElementById('tube-v-eff').value = '34300';
            document.getElementById('tube-damping').value = 'medium';
            document.getElementById('tube-f-tube').value = '';
            document.getElementById('tube-L-total').value = '';
            document.getElementById('tube-temp').value = '20.0';
            hideMessages('tube');
            document.getElementById('tube-velocity-result').style.display = 'none';
            updateTubeWall();
        }
        
        // ========== –†–ê–°–¢–†–£–ë–´ ==========
        
        function calculateBellEffect() {
            const f_no = parseFloat(document.getElementById('bell-f-no').value);
            const f_with = parseFloat(document.getElementById('bell-f-with').value);
            const v_sound = parseFloat(document.getElementById('bell-v-sound').value);
            
            if (!f_no || !f_with || f_no <= 0 || f_with <= 0) {
                showError('bell-error', '–í–≤–µ–¥–∏—Ç–µ –æ–±–µ —á–∞—Å—Ç–æ—Ç—ã (—Å —Ä–∞—Å—Ç—Ä—É–±–æ–º –∏ –±–µ–∑)');
                return;
            }
            
            // ŒîL_bell = v / (2 * (1/f_with_bell - 1/f_no_bell))
            // –ø–µ—Ä–µ–≤–æ–¥–∏–º –≤ –º–º: v –≤ —Å–º/—Å ‚Üí –º–º/—Å *100
            const v_mm_per_s = v_sound * 10; // —Å–º/—Å ‚Üí –º–º/—Å
            const delta_L = v_mm_per_s / (2 * (1/f_with - 1/f_no));
            
            document.getElementById('delta-L-value').textContent = delta_L.toFixed(1);
            document.getElementById('bell-effect-result').style.display = 'block';
        }
        
        function useCalculatedDeltaL() {
            const deltaL = parseFloat(document.getElementById('delta-L-value').textContent);
            document.getElementById('bell-delta-L').value = deltaL;
            showSuccess('bell-success', `ŒîL_bell —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: ${deltaL.toFixed(1)}–º–º`);
        }
        
        function fillSaxBellExample() {
            document.getElementById('bell-name').value = 'Alto_Sax_Bell_Example';
            document.getElementById('bell-type').value = 'exponential';
            document.getElementById('bell-material').value = 'brass';
            document.getElementById('bell-d-in').value = '28.0';
            document.getElementById('bell-d-out').value = '80.0';
            document.getElementById('bell-length').value = '150.0';
            document.getElementById('bell-wall').value = '0.5';
            document.getElementById('bell-delta-L').value = '-12.5';
            document.getElementById('bell-profile').value = '0–º–º: 28–º–º, 50–º–º: 54–º–º, 100–º–º: 72–º–º, 150–º–º: 80–º–º';
            document.getElementById('bell-acoustic').value = 'strong';
            updateBellCalculations();
        }
        
        async function loadBells() {
            try {
                const response = await fetch('/api/bells');
                const data = await response.json();
                
                document.getElementById('bells-loading').style.display = 'none';
                const container = document.getElementById('bells-list');
                container.innerHTML = '';
                
                if (data.bells && data.bells.length > 0) {
                    data.bells.forEach(bell => {
                        const card = createBellCard(bell);
                        container.appendChild(card);
                    });
                } else {
                    container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">–†–∞—Å—Ç—Ä—É–±–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å—Ç—Ä—É–±–æ–≤:', error);
                document.getElementById('bells-loading').innerHTML = 
                    '<p style="color: red;">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</p>';
            }
        }
        
        function createBellCard(bell) {
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ—Ä–µ–Ω–∏–π
            let measurementStatus = 'status-required';
            let statusText = '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
            
            if (bell.delta_L !== undefined && bell.delta_L !== 0) {
                measurementStatus = 'status-complete';
                statusText = '–ò–∑–º–µ—Ä–µ–Ω–æ';
            } else if (bell.start_diameter && bell.end_diameter) {
                measurementStatus = 'status-partial';
                statusText = '–ß–∞—Å—Ç–∏—á–Ω–æ';
            }
            
            const expansion = bell.expansion_ratio || (bell.end_diameter / bell.start_diameter);
            
            const card = document.createElement('div');
            card.className = 'component-card';
            card.dataset.id = bell.id;
            card.dataset.type = 'bells';
            
            card.innerHTML = `
                <div class="measurement-status ${measurementStatus}">${statusText}</div>
                <h3>${bell.name}</h3>
                <div class="component-param">
                    <span class="param-label">–¢–∏–ø:</span>
                    <span class="param-value">${getBellTypeName(bell.type)}</span>
                </div>
                <div class="component-param">
                    <span class="param-label">ŒîL_bell:</span>
                    <span class="param-value">${bell.delta_L ? bell.delta_L.toFixed(1) + ' –º–º' : '–ù–µ –∏–∑–º–µ—Ä–µ–Ω–æ'}</span>
                </div>
                <div class="component-param">
                    <span class="param-label">–î–∏–∞–º–µ—Ç—Ä:</span>
                    <span class="param-value">${bell.start_diameter ? bell.start_diameter.toFixed(1) : '?'} ‚Üí ${bell.end_diameter ? bell.end_diameter.toFixed(1) : '?'} –º–º</span>
                </div>
                <div class="component-param">
                    <span class="param-label">–î–ª–∏–Ω–∞:</span>
                    <span class="param-value">${bell.length ? bell.length.toFixed(1) + ' –º–º' : '?'}</span>
                </div>
                <div class="component-param">
                    <span class="param-label">–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ:</span>
                    <span class="param-value">${expansion.toFixed(2)}x</span>
                </div>
                <div style="margin-top: 15px; display: flex; gap: 10px; justify-content: flex-end;">
                    <button onclick="selectComponent(${bell.id}, 'bells', '${bell.name}')" 
                            class="btn btn-secondary" 
                            style="padding: 5px 10px; font-size: 14px;">
                        ‚úÖ –í—ã–±—Ä–∞—Ç—å
                    </button>
                    <button onclick="deleteComponent('bells', ${bell.id})" 
                            class="btn btn-danger" 
                            style="padding: 5px 10px; font-size: 14px;">
                        –£–¥–∞–ª–∏—Ç—å
                    </button>
                </div>
            `;
            return card;
        }
        
        function getBellTypeName(type) {
            const names = {
                'flare': '–ö–æ–Ω—É—Å',
                'straight': '–¶–∏–ª–∏–Ω–¥—Ä',
                'none': '–ë–µ–∑ —Ä–∞—Å—Ç—Ä—É–±–∞',
                'exponential': '–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π',
                'parabolic': '–ü–∞—Ä–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π',
                'step': '–°—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π',
                'trumpet': '–¢—Ä—É–±–Ω—ã–π',
                'flute': '–§–ª–µ–π—Ç–æ–≤—ã–π'
            };
            return names[type] || type;
        }
        
        async function addBell() {
            const data = {
                name: document.getElementById('bell-name').value.trim(),
                type: document.getElementById('bell-type').value,
                material: document.getElementById('bell-material').value,
                start_diameter: parseFloat(document.getElementById('bell-d-in').value),
                end_diameter: parseFloat(document.getElementById('bell-d-out').value),
                length: parseFloat(document.getElementById('bell-length').value),
                wall_thickness: parseFloat(document.getElementById('bell-wall').value),
                expansion_ratio: parseFloat(document.getElementById('bell-expansion').value),
                flare_angle: parseFloat(document.getElementById('bell-angle').value),
                delta_L: parseFloat(document.getElementById('bell-delta-L').value),
                acoustic_effect: document.getElementById('bell-acoustic').value,
                profile: document.getElementById('bell-profile').value.trim(),
                
                // –î–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
                f_no_bell: parseFloat(document.getElementById('bell-f-no').value),
                f_with_bell: parseFloat(document.getElementById('bell-f-with').value),
                v_sound: parseFloat(document.getElementById('bell-v-sound').value)
            };
            
            if (!data.name) {
                showError('bell-error', '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–∞—Å—Ç—Ä—É–±–∞');
                return;
            }
            
            if (!data.start_diameter || !data.end_diameter || !data.length) {
                showError('bell-error', '–í–≤–µ–¥–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—Ç—Ä—É–±–∞');
                return;
            }
            
            try {
                const response = await fetch('/api/bells', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    showSuccess('bell-success', `–†–∞—Å—Ç—Ä—É–± "${data.name}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω!`);
                    resetBellForm();
                    loadBells();
                } else {
                    showError('bell-error', result.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏');
                }
            } catch (error) {
                showError('bell-error', `–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`);
            }
        }
        
        function resetBellForm() {
            document.getElementById('bell-name').value = '';
            document.getElementById('bell-type').value = 'flare';
            document.getElementById('bell-material').value = 'same';
            document.getElementById('bell-d-in').value = '28.0';
            document.getElementById('bell-d-out').value = '80.0';
            document.getElementById('bell-length').value = '150.0';
            document.getElementById('bell-wall').value = '1.5';
            document.getElementById('bell-delta-L').value = '-12.5';
            document.getElementById('bell-acoustic').value = 'medium';
            document.getElementById('bell-profile').value = '';
            document.getElementById('bell-f-no').value = '';
            document.getElementById('bell-f-with').value = '';
            document.getElementById('bell-v-sound').value = '34300';
            hideMessages('bell');
            document.getElementById('bell-effect-result').style.display = 'none';
            updateBellCalculations();
        }
        
        // ========== –û–ë–©–ò–ï –§–£–ù–ö–¶–ò–ò ==========
        
        // –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
        function selectComponent(id, type, name) {
            console.log(`–í—ã–±–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞: ${type} ID=${id}, –Ω–∞–∑–≤–∞–Ω–∏–µ=${name}`);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
            selectedComponents[type] = id;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showSuccess(`${type}-success`, `–í—ã–±—Ä–∞–Ω–æ: ${name}`);
            
            // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
            console.log('–¢–µ–∫—É—â–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:', selectedComponents);
            
            // –ï—Å–ª–∏ —ç—Ç–æ –≤—ã–±–æ—Ä –∏–∑ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–º –≤—ã–±–æ—Ä
            if (window.parent && window.parent.updateSelectedComponents) {
                window.parent.updateSelectedComponents(type, id, name);
            }
        }
        
        async function deleteComponent(type, id) {
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç ${getComponentName(type)}?`)) {
                return;
            }
            
            try {
                const response = await fetch(`/api/${type}/${id}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫
                    if (type === 'mouthpieces') loadMouthpieces();
                    else if (type === 'tubes') loadTubes();
                    else if (type === 'bells') loadBells();
                    
                    showSuccess(`${type}-success`, `${getComponentName(type).charAt(0).toUpperCase() + getComponentName(type).slice(1)} —É–¥–∞–ª–µ–Ω`);
                } else {
                    showError(`${type}-error`, '–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏');
                }
            } catch (error) {
                showError(`${type}-error`, `–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`);
            }
        }
        
        function getComponentName(type) {
            const names = {
                'mouthpieces': '–º—É–Ω–¥—à—Ç—É–∫',
                'tubes': '—Ç—Ä—É–±–∫—É',
                'bells': '—Ä–∞—Å—Ç—Ä—É–±'
            };
            return names[type] || '–∫–æ–º–ø–æ–Ω–µ–Ω—Ç';
        }
        
        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.style.display = 'block';
            setTimeout(() => {
                element.style.display = 'none';
            }, 5000);
        }
        
        function showSuccess(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.style.display = 'block';
            setTimeout(() => {
                element.style.display = 'none';
            }, 3000);
        }
        
        function hideMessages(prefix) {
            document.getElementById(`${prefix}-error`).style.display = 'none';
            document.getElementById(`${prefix}-success`).style.display = 'none';
        }
    </script>
</body>
</html>